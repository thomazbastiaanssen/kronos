---
title: "Benchmarking Kronos and other circadian packages"
author: "Sarah-Jane Leigh & Thomaz F.S. Bastiaanssen"
date: "2022-10-26"
output:
  md_document:
    variant: gfm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load}
library(tidyverse)

#devtools::install_github("thomazbastiaanssen/kronos") 
library(kronos)

#install.packages('limorhyde')
library(limorhyde)

library(cosinor)
library(cosinor2)

```

```{r load and clean}
source("00_load_and_clean_WGS.R")

```

```{r run tools}
source("01a_run_kronos.R")
source("01b_run_jtk_cycle.R")
source("01c_run_limorhyde.R")
source("01d_run_cosinor2.R")

head(res_kronos)
head(res_jtk)
head(res_limo)

plot(res_kronos$p.val, res_jtk$ADJ.P)
hist(res_kronos$p.val, breaks = 20)
hist(res_jtk$ADJ.P, breaks = 20)
hist(res_cosinor2$p, breaks = 20)

plot(res_kronos$amplitude, res_jtk$AMP)
plot(res_kronos$acro, res_jtk$LAG)

plot(res_kronos$acro, res_cosinor2$acrophase + 24)


```